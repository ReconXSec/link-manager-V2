<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nexus â€” Ù…Ø¯ÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #060810;
  --bg1: #0d1117;
  --bg2: #111827;
  --bg3: #1a2234;
  --surface: rgba(255,255,255,0.04);
  --border: rgba(255,255,255,0.07);
  --border2: rgba(255,255,255,0.12);
  --fg: #f0f4ff;
  --fg2: #8892a4;
  --fg3: #555f72;
  --cyan: #00e5ff;
  --cyan2: #00b4d8;
  --violet: #7c3aed;
  --violet2: #a855f7;
  --pink: #ec4899;
  --emerald: #10b981;
  --amber: #f59e0b;
  --red: #ef4444;
  --glow-c: rgba(0,229,255,0.15);
  --glow-v: rgba(124,58,237,0.15);
  --glow-p: rgba(236,72,153,0.15);
  --r: 16px;
  --r2: 12px;
}

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}

body {
  font-family: 'IBM Plex Sans Arabic', sans-serif;
  background: var(--bg);
  color: var(--fg);
  min-height: 100vh;
  overflow-x: hidden;
}

/* â”€â”€ Scrollbar â”€â”€ */
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-track{background:var(--bg1)}
::-webkit-scrollbar-thumb{background:var(--bg3);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--violet)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS BACKGROUND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#bg-canvas {
  position: fixed;inset:0;
  z-index: 0;pointer-events:none;
  opacity: .6;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOGIN PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#login-page {
  position: relative;z-index:1;
  min-height:100vh;
  display:flex;align-items:center;justify-content:center;
  padding:24px;
}

.login-wrap {
  width:100%;max-width:440px;
  position:relative;
}

.login-glow {
  position:absolute;
  width:300px;height:300px;
  background:radial-gradient(circle, var(--violet) 0%, transparent 70%);
  top:-100px;left:50%;transform:translateX(-50%);
  opacity:.25;filter:blur(60px);
  pointer-events:none;
  animation: glowPulse 4s ease-in-out infinite;
}

@keyframes glowPulse {
  0%,100%{opacity:.2;transform:translateX(-50%) scale(1)}
  50%{opacity:.35;transform:translateX(-50%) scale(1.1)}
}

.login-card {
  background: rgba(13,17,23,0.85);
  backdrop-filter: blur(30px);
  border: 1px solid var(--border2);
  border-radius: 24px;
  padding: 48px 40px;
  position: relative;
  overflow: hidden;
}

.login-card::before {
  content:'';
  position:absolute;inset:0;
  background: linear-gradient(135deg, rgba(124,58,237,.08) 0%, rgba(0,229,255,.05) 100%);
  pointer-events:none;
}

.login-card::after {
  content:'';
  position:absolute;top:0;left:0;right:0;height:1px;
  background: linear-gradient(90deg, transparent, var(--violet2), var(--cyan), transparent);
}

.login-logo {
  display:flex;align-items:center;gap:14px;
  justify-content:center;margin-bottom:32px;
}

.login-logo-icon {
  width:52px;height:52px;
  background: linear-gradient(135deg, var(--violet), var(--cyan2));
  border-radius:14px;
  display:flex;align-items:center;justify-content:center;
  font-size:26px;
  box-shadow: 0 0 30px var(--glow-v);
  animation: floatIcon 3s ease-in-out infinite;
}

@keyframes floatIcon {
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-6px)}
}

.login-logo-text {
  font-family:'Outfit',sans-serif;
  font-size:28px;font-weight:900;letter-spacing:-1px;
  background: linear-gradient(135deg, var(--fg), var(--cyan));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}

.login-subtitle {
  text-align:center;color:var(--fg2);
  font-size:14px;margin-bottom:36px;
  line-height:1.6;
}

.setup-badge {
  display:flex;align-items:center;gap:8px;
  background:rgba(0,229,255,.08);
  border:1px solid rgba(0,229,255,.2);
  border-radius:10px;padding:12px 16px;
  margin-bottom:24px;font-size:13px;
  color:var(--cyan);
  display:none;
}

.field-label {
  font-size:12px;font-weight:600;
  letter-spacing:.8px;text-transform:uppercase;
  color:var(--fg3);margin-bottom:10px;display:block;
}

.field-wrap {
  position:relative;margin-bottom:20px;
}

.field-input {
  width:100%;padding:14px 46px 14px 18px;
  background:rgba(255,255,255,.05);
  border:1.5px solid var(--border2);
  border-radius:12px;
  font-family:inherit;font-size:15px;
  color:var(--fg);outline:none;
  transition:all .3s;direction:rtl;
}

.field-input:focus {
  border-color:var(--cyan);
  background:rgba(0,229,255,.04);
  box-shadow:0 0 0 3px rgba(0,229,255,.1);
}

.field-input::placeholder{color:var(--fg3)}

.field-icon {
  position:absolute;right:14px;top:50%;
  transform:translateY(-50%);
  color:var(--fg3);font-size:18px;
  pointer-events:none;
}

.login-btn {
  width:100%;padding:15px;
  background: linear-gradient(135deg, var(--violet), var(--cyan2));
  border:none;border-radius:12px;
  font-family:inherit;font-size:16px;font-weight:700;
  color:white;cursor:pointer;
  transition:all .3s;
  position:relative;overflow:hidden;
  box-shadow:0 8px 32px rgba(124,58,237,.4);
}

.login-btn::after {
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.15),transparent);
  opacity:0;transition:opacity .3s;
}

.login-btn:hover{transform:translateY(-2px);box-shadow:0 12px 40px rgba(124,58,237,.5)}
.login-btn:hover::after{opacity:1}
.login-btn:active{transform:translateY(0)}

.login-error {
  margin-top:14px;padding:12px 16px;
  background:rgba(239,68,68,.1);
  border:1px solid rgba(239,68,68,.25);
  border-radius:10px;
  color:#fca5a5;font-size:13px;
  text-align:center;display:none;
}

.attempts-bar {
  margin-top:14px;padding:12px 16px;
  background:rgba(245,158,11,.08);
  border:1px solid rgba(245,158,11,.2);
  border-radius:10px;color:var(--amber);
  font-size:13px;display:none;
}

.locked-state {
  text-align:center;padding:20px;
  background:rgba(239,68,68,.08);
  border:1px solid rgba(239,68,68,.2);
  border-radius:12px;margin-top:16px;display:none;
}

.locked-state .lock-icon{font-size:48px;margin-bottom:12px}
.locked-state h3{font-size:18px;font-weight:700;color:var(--red);margin-bottom:8px}
.locked-state p{font-size:13px;color:var(--fg2)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app{display:none;position:relative;z-index:1}

/* â”€â”€ Header â”€â”€ */
.app-header {
  position:sticky;top:0;z-index:200;
  background:rgba(6,8,16,.85);
  backdrop-filter:blur(24px);
  border-bottom:1px solid var(--border);
}

.header-inner {
  max-width:1440px;margin:0 auto;
  padding:0 28px;height:68px;
  display:flex;align-items:center;
  gap:20px;
}

.h-logo {
  display:flex;align-items:center;gap:10px;
  flex-shrink:0;cursor:pointer;
}

.h-logo-icon {
  width:38px;height:38px;
  background:linear-gradient(135deg,var(--violet),var(--cyan2));
  border-radius:10px;
  display:flex;align-items:center;justify-content:center;
  font-size:18px;
  box-shadow:0 0 16px var(--glow-v);
}

.h-logo-name {
  font-family:'Outfit',sans-serif;
  font-size:20px;font-weight:900;
  letter-spacing:-0.5px;
  background:linear-gradient(135deg,var(--fg),var(--cyan));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}

.h-search {
  flex:1;max-width:500px;position:relative;
}

.h-search input {
  width:100%;padding:10px 44px 10px 18px;
  background:rgba(255,255,255,.05);
  border:1.5px solid var(--border);
  border-radius:50px;
  font-family:inherit;font-size:14px;
  color:var(--fg);outline:none;
  transition:all .3s;direction:rtl;
}

.h-search input:focus {
  border-color:var(--cyan);
  background:rgba(0,229,255,.04);
  box-shadow:0 0 0 3px rgba(0,229,255,.1);
}

.h-search input::placeholder{color:var(--fg3)}

.h-search-ico {
  position:absolute;left:14px;top:50%;
  transform:translateY(-50%);color:var(--fg3);
  pointer-events:none;
}

.h-search-ico svg{width:16px;height:16px}

.h-actions{display:flex;gap:8px;margin-right:auto;align-items:center;flex-shrink:0}

.h-btn {
  width:40px;height:40px;
  display:flex;align-items:center;justify-content:center;
  background:rgba(255,255,255,.05);
  border:1px solid var(--border);
  border-radius:10px;cursor:pointer;color:var(--fg2);
  transition:all .3s;position:relative;
}

.h-btn:hover {
  background:rgba(124,58,237,.2);
  border-color:var(--violet2);
  color:var(--fg);transform:translateY(-1px);
}

.h-btn svg{width:18px;height:18px}

.h-btn-add {
  display:flex;align-items:center;gap:8px;
  padding:0 18px;height:40px;width:auto;
  background:linear-gradient(135deg,var(--violet),var(--cyan2));
  border:none;border-radius:10px;
  font-family:inherit;font-size:13px;font-weight:700;
  color:white;cursor:pointer;white-space:nowrap;
  transition:all .3s;
  box-shadow:0 4px 20px rgba(124,58,237,.4);
}

.h-btn-add:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(124,58,237,.5)}
.h-btn-add svg{width:16px;height:16px}

/* â”€â”€ Main Layout â”€â”€ */
.main {
  max-width:1440px;margin:0 auto;
  padding:32px 28px 60px;
}

/* â”€â”€ Hero Banner â”€â”€ */
.hero-banner {
  position:relative;overflow:hidden;
  border-radius:24px;
  padding:40px 44px;
  margin-bottom:28px;
  background: linear-gradient(135deg, rgba(124,58,237,.25) 0%, rgba(0,229,255,.15) 100%);
  border:1px solid rgba(124,58,237,.25);
}

.hero-banner::before {
  content:'';position:absolute;
  top:-60%;right:-20%;
  width:500px;height:500px;
  background:radial-gradient(circle, var(--violet) 0%, transparent 70%);
  opacity:.15;filter:blur(40px);
  pointer-events:none;
}

.hero-banner::after {
  content:'';position:absolute;
  bottom:-60%;left:5%;
  width:400px;height:400px;
  background:radial-gradient(circle, var(--cyan2) 0%, transparent 70%);
  opacity:.1;filter:blur(50px);
  pointer-events:none;
}

.hero-content{position:relative;z-index:1}

.hero-title {
  font-family:'Outfit',sans-serif;
  font-size:clamp(22px,4vw,34px);
  font-weight:800;letter-spacing:-0.5px;
  margin-bottom:8px;
}

.hero-title span {
  background:linear-gradient(135deg,var(--cyan),var(--violet2));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}

.hero-desc{font-size:14px;color:var(--fg2);margin-bottom:28px;font-weight:300}

.hero-stats{display:flex;gap:36px;flex-wrap:wrap}

.hero-stat {
  display:flex;flex-direction:column;gap:4px;
}

.hero-stat .hs-val {
  font-family:'Outfit',sans-serif;
  font-size:32px;font-weight:800;line-height:1;
  background:linear-gradient(135deg,var(--fg),var(--cyan));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}

.hero-stat .hs-lbl {
  font-size:12px;color:var(--fg3);letter-spacing:.5px;
}

.hero-stat-div{width:1px;background:var(--border2);align-self:stretch}

/* â”€â”€ Stats Grid â”€â”€ */
.stats-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:16px;margin-bottom:28px;
}

.stat-card {
  background:var(--bg1);
  border:1px solid var(--border);
  border-radius:18px;
  padding:22px 20px;
  display:flex;align-items:center;gap:16px;
  cursor:pointer;
  transition:all .35s;
  position:relative;overflow:hidden;
}

.stat-card::after {
  content:'';position:absolute;
  inset:0;border-radius:18px;
  background:linear-gradient(135deg, rgba(255,255,255,.03), transparent);
  pointer-events:none;
}

.stat-card:hover {
  transform:translateY(-4px);
  border-color:var(--border2);
  box-shadow:0 16px 40px rgba(0,0,0,.4);
}

.stat-card.active-filter {
  border-color: var(--cyan);
  box-shadow: 0 0 0 1px var(--cyan), 0 8px 32px rgba(0,229,255,.2);
}

.stat-ico {
  width:48px;height:48px;flex-shrink:0;
  border-radius:14px;
  display:flex;align-items:center;justify-content:center;
}

.stat-ico svg{width:22px;height:22px}

.stat-ico.all    {background:linear-gradient(135deg,#7c3aed,#a855f7);box-shadow:0 4px 16px rgba(124,58,237,.4)}
.stat-ico.course {background:linear-gradient(135deg,#ec4899,#f43f5e);box-shadow:0 4px 16px rgba(236,72,153,.4)}
.stat-ico.tool   {background:linear-gradient(135deg,#00e5ff,#00b4d8);box-shadow:0 4px 16px rgba(0,229,255,.4)}
.stat-ico.article{background:linear-gradient(135deg,#f59e0b,#ef4444);box-shadow:0 4px 16px rgba(245,158,11,.4)}
.stat-ico.important{background:linear-gradient(135deg,#10b981,#06b6d4);box-shadow:0 4px 16px rgba(16,185,129,.4)}
.stat-ico.fav    {background:linear-gradient(135deg,#f43f5e,#ec4899);box-shadow:0 4px 16px rgba(244,63,94,.4)}
.stat-ico.other  {background:linear-gradient(135deg,#8b5cf6,#6366f1);box-shadow:0 4px 16px rgba(139,92,246,.4)}

.stat-info h3 {
  font-family:'Outfit',sans-serif;
  font-size:26px;font-weight:800;line-height:1;
  margin-bottom:4px;
}

.stat-info p{font-size:12px;color:var(--fg3);font-weight:500}

/* â”€â”€ Controls Bar â”€â”€ */
.controls-bar {
  display:flex;align-items:center;
  justify-content:space-between;
  gap:12px;margin-bottom:20px;flex-wrap:wrap;
}

.view-toggle {
  display:flex;background:var(--bg1);
  border:1px solid var(--border);
  border-radius:10px;padding:4px;gap:2px;
}

.vt-btn {
  width:36px;height:36px;
  display:flex;align-items:center;justify-content:center;
  background:transparent;border:none;
  border-radius:7px;cursor:pointer;
  color:var(--fg3);transition:all .25s;
}

.vt-btn:hover{color:var(--fg)}
.vt-btn.active{background:rgba(124,58,237,.3);color:var(--cyan)}
.vt-btn svg{width:17px;height:17px}

.sort-select {
  padding:8px 14px;
  background:var(--bg1);border:1px solid var(--border);
  border-radius:10px;
  font-family:inherit;font-size:13px;color:var(--fg2);
  outline:none;cursor:pointer;direction:rtl;
  transition:border-color .25s;
}

.sort-select:focus{border-color:var(--cyan)}

.results-count {
  font-size:13px;color:var(--fg3);margin-right:auto;
}

.results-count span{color:var(--cyan);font-weight:700}

/* â”€â”€ Cards Grid â”€â”€ */
.cards-grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(310px,1fr));
  gap:20px;
}

.cards-list {
  display:flex;flex-direction:column;gap:14px;
}

/* â”€â”€ Link Card â”€â”€ */
.link-card {
  background:var(--bg1);
  border:1px solid var(--border);
  border-radius:20px;
  overflow:hidden;
  transition:all .35s;
  cursor:pointer;
  position:relative;
  animation: cardIn .4s ease forwards;
}

@keyframes cardIn {
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1;transform:translateY(0)}
}

.link-card:hover {
  transform:translateY(-6px);
  border-color:var(--border2);
  box-shadow:0 20px 60px rgba(0,0,0,.5);
}

/* Category color strip */
.link-card::before {
  content:'';position:absolute;
  top:0;right:0;width:3px;height:100%;z-index:2;
}

.link-card.course::before   {background:linear-gradient(180deg,var(--pink),#f43f5e)}
.link-card.tool::before     {background:linear-gradient(180deg,var(--cyan),var(--cyan2))}
.link-card.article::before  {background:linear-gradient(180deg,var(--amber),#ef4444)}
.link-card.important::before{background:linear-gradient(180deg,var(--emerald),#06b6d4)}
.link-card.other::before    {background:linear-gradient(180deg,var(--violet2),var(--violet))}

/* Card Image */
.card-img {
  position:relative;height:170px;overflow:hidden;
}

.card-img img {
  width:100%;height:100%;object-fit:cover;
  transition:transform .5s ease;
}

.link-card:hover .card-img img {transform:scale(1.05)}

.card-img-ph {
  width:100%;height:100%;
  display:flex;align-items:center;justify-content:center;
  position:relative;overflow:hidden;
}

.card-img-ph canvas{width:100%;height:100%;display:block}

.card-img-ph .ph-icon {
  position:absolute;
  font-size:56px;opacity:.15;
}

.card-img-overlay {
  position:absolute;inset:0;
  background:linear-gradient(180deg, transparent 30%, rgba(6,8,16,.9) 100%);
  opacity:0;transition:opacity .3s;
}

.link-card:hover .card-img-overlay{opacity:1}

.card-actions-float {
  position:absolute;top:10px;left:10px;
  display:flex;gap:6px;z-index:5;
}

.ca-btn {
  width:33px;height:33px;
  display:flex;align-items:center;justify-content:center;
  background:rgba(6,8,16,.8);
  backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,.1);
  border-radius:9px;cursor:pointer;
  color:var(--fg2);transition:all .25s;
}

.ca-btn:hover{background:var(--violet);border-color:var(--violet2);color:white;transform:scale(1.1)}
.ca-btn.fav-on{background:var(--red);border-color:var(--red);color:white}
.ca-btn.del-btn:hover{background:var(--red);border-color:var(--red)}
.ca-btn svg{width:14px;height:14px}

.card-cat-badge {
  position:absolute;bottom:10px;right:12px;z-index:3;
  padding:4px 12px;border-radius:20px;
  font-size:11px;font-weight:700;letter-spacing:.3px;
  backdrop-filter:blur(12px);
}

.card-cat-badge.course   {background:rgba(236,72,153,.85);color:white}
.card-cat-badge.tool     {background:rgba(0,229,255,.2);color:var(--cyan);border:1px solid rgba(0,229,255,.3)}
.card-cat-badge.article  {background:rgba(245,158,11,.85);color:black}
.card-cat-badge.important{background:rgba(16,185,129,.85);color:white}
.card-cat-badge.other    {background:rgba(124,58,237,.85);color:white}

/* Card Body */
.card-body{padding:20px 20px 16px}

.card-title {
  font-family:'Outfit',sans-serif;
  font-size:17px;font-weight:700;line-height:1.35;
  margin-bottom:8px;color:var(--fg);
  display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;
}

.card-url {
  display:flex;align-items:center;gap:6px;
  font-size:12px;color:var(--cyan2);
  margin-bottom:10px;cursor:pointer;
  word-break:break-all;
  transition:color .2s;
}

.card-url:hover{color:var(--cyan);text-decoration:underline}
.card-url svg{width:12px;height:12px;flex-shrink:0}

.card-desc {
  font-size:13px;color:var(--fg2);
  line-height:1.6;margin-bottom:12px;
  display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;
  font-weight:300;
}

.card-tags {
  display:flex;flex-wrap:wrap;gap:5px;margin-bottom:14px;
}

.card-tag {
  padding:3px 10px;
  background:rgba(255,255,255,.05);
  border:1px solid var(--border2);
  border-radius:20px;
  font-size:11px;color:var(--fg3);
  transition:all .2s;
}

.card-tag:hover{border-color:var(--violet2);color:var(--violet2);cursor:pointer}

.card-footer {
  display:flex;align-items:center;justify-content:space-between;
  padding-top:14px;
  border-top:1px solid var(--border);
  gap:8px;flex-wrap:wrap;
}

.card-meta {
  display:flex;align-items:center;gap:12px;
  font-size:11px;color:var(--fg3);flex-wrap:wrap;
}

.card-meta-item {
  display:flex;align-items:center;gap:4px;
}

.card-meta-item svg{width:12px;height:12px;opacity:.7}

.card-visit-btn {
  display:flex;align-items:center;gap:5px;
  padding:7px 16px;
  background:rgba(124,58,237,.2);
  border:1px solid rgba(124,58,237,.3);
  border-radius:20px;
  font-family:inherit;font-size:12px;font-weight:600;
  color:var(--violet2);cursor:pointer;
  transition:all .25s;white-space:nowrap;
}

.card-visit-btn:hover{
  background:linear-gradient(135deg,var(--violet),var(--cyan2));
  border-color:transparent;color:white;
  box-shadow:0 4px 16px rgba(124,58,237,.4);
}

.card-visit-btn svg{width:13px;height:13px}

/* â”€â”€ List View Card â”€â”€ */
.link-card.list-mode {
  display:flex;flex-direction:row;
  border-radius:16px;
}

.link-card.list-mode .card-img {
  width:130px;min-width:130px;height:auto;
}

.link-card.list-mode .card-body {
  flex:1;min-width:0;
  padding:16px 18px;
  display:flex;flex-direction:column;justify-content:center;
}

.link-card.list-mode .card-title{font-size:15px;-webkit-line-clamp:1}
.link-card.list-mode .card-desc{display:none}
.link-card.list-mode .card-img-ph{height:100%}

@media(max-width:600px) {
  .link-card.list-mode{flex-direction:column}
  .link-card.list-mode .card-img{width:100%;height:140px}
}

/* â”€â”€ Empty State â”€â”€ */
.empty-state {
  grid-column:1/-1;
  text-align:center;padding:80px 24px;
}

.empty-icon {
  width:80px;height:80px;
  background:rgba(124,58,237,.1);
  border:1px solid rgba(124,58,237,.2);
  border-radius:20px;
  display:flex;align-items:center;justify-content:center;
  margin:0 auto 20px;
}

.empty-icon svg{width:36px;height:36px;color:var(--violet2)}
.empty-state h3{font-family:'Outfit',sans-serif;font-size:22px;font-weight:700;margin-bottom:8px}
.empty-state p{font-size:14px;color:var(--fg2);margin-bottom:24px;font-weight:300}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  display:none;position:fixed;inset:0;
  z-index:1000;
  background:rgba(0,0,0,.7);
  backdrop-filter:blur(12px);
  align-items:center;justify-content:center;
  padding:20px;overflow-y:auto;
}

.modal {
  background:var(--bg1);
  border:1px solid var(--border2);
  border-radius:24px;
  width:100%;max-width:580px;
  max-height:90vh;overflow-y:auto;
  box-shadow:0 32px 80px rgba(0,0,0,.6);
  animation:modalIn .3s cubic-bezier(.34,1.56,.64,1);
  position:relative;margin:auto;
}

@keyframes modalIn {
  from{transform:translateY(-30px) scale(.97);opacity:0}
  to{transform:translateY(0) scale(1);opacity:1}
}

.modal::before {
  content:'';position:absolute;
  top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,var(--violet2),var(--cyan),transparent);
}

.modal-head {
  padding:24px 28px;
  border-bottom:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;
  position:sticky;top:0;z-index:10;
  background:var(--bg1);
}

.modal-head h2{
  font-family:'Outfit',sans-serif;
  font-size:20px;font-weight:800;
}

.modal-close {
  width:36px;height:36px;
  display:flex;align-items:center;justify-content:center;
  background:rgba(255,255,255,.05);border:1px solid var(--border);
  border-radius:9px;cursor:pointer;color:var(--fg2);
  transition:all .25s;flex-shrink:0;
}

.modal-close:hover{background:var(--red);border-color:var(--red);color:white}
.modal-close svg{width:16px;height:16px}

.modal-body{padding:24px 28px}

.form-group{margin-bottom:20px}

.form-label{
  display:block;font-size:12px;font-weight:600;
  letter-spacing:.8px;text-transform:uppercase;
  color:var(--fg3);margin-bottom:10px;
}

.form-input,.form-select,.form-textarea {
  width:100%;padding:13px 16px;
  background:rgba(255,255,255,.05);
  border:1.5px solid var(--border2);
  border-radius:12px;
  font-family:inherit;font-size:14px;color:var(--fg);
  outline:none;transition:all .3s;direction:rtl;
}

.form-input:focus,.form-select:focus,.form-textarea:focus {
  border-color:var(--cyan);
  background:rgba(0,229,255,.04);
  box-shadow:0 0 0 3px rgba(0,229,255,.1);
}

.form-input::placeholder,.form-textarea::placeholder{color:var(--fg3)}
.form-textarea{min-height:90px;resize:vertical;line-height:1.6}

.form-select option{background:var(--bg2);color:var(--fg)}

.img-zone {
  border:2px dashed rgba(255,255,255,.1);
  border-radius:14px;padding:32px;
  text-align:center;cursor:pointer;
  transition:all .3s;background:rgba(255,255,255,.02);
  position:relative;overflow:hidden;
}

.img-zone:hover{border-color:var(--violet2);background:rgba(124,58,237,.05)}
.img-zone input{position:absolute;inset:0;opacity:0;cursor:pointer}

.img-zone-icon{font-size:36px;margin-bottom:10px;opacity:.4}
.img-zone-text{font-size:13px;color:var(--fg3)}
.img-zone-text span{color:var(--violet2);font-weight:600}

.img-preview-wrap {
  position:relative;margin-top:14px;
  border-radius:12px;overflow:hidden;
}

.img-preview-wrap img{width:100%;height:180px;object-fit:cover;display:block}

.img-preview-remove {
  position:absolute;top:8px;left:8px;
  width:30px;height:30px;
  background:var(--red);border:none;
  border-radius:50%;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  color:white;font-size:16px;font-weight:700;
  transition:transform .2s;
}

.img-preview-remove:hover{transform:scale(1.1)}

.modal-foot {
  padding:20px 28px;
  border-top:1px solid var(--border);
  display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap;
}

.btn-cancel {
  padding:11px 22px;background:rgba(255,255,255,.05);
  border:1px solid var(--border2);border-radius:10px;
  font-family:inherit;font-size:14px;font-weight:600;
  color:var(--fg2);cursor:pointer;transition:all .25s;
}

.btn-cancel:hover{border-color:var(--fg3);color:var(--fg)}

.btn-save {
  padding:11px 28px;
  background:linear-gradient(135deg,var(--violet),var(--cyan2));
  border:none;border-radius:10px;
  font-family:inherit;font-size:14px;font-weight:700;
  color:white;cursor:pointer;transition:all .3s;
  box-shadow:0 4px 20px rgba(124,58,237,.4);
}

.btn-save:hover{transform:translateY(-1px);box-shadow:0 8px 28px rgba(124,58,237,.5)}

/* â”€â”€ Settings Modal special â”€â”€ */
.settings-section{margin-bottom:24px}
.settings-section-title {
  font-size:12px;letter-spacing:1px;text-transform:uppercase;
  color:var(--fg3);font-weight:600;
  margin-bottom:14px;
  display:flex;align-items:center;gap:8px;
}

.settings-section-title::after{
  content:'';flex:1;height:1px;background:var(--border);
}

.settings-btn {
  width:100%;padding:12px 16px;
  background:rgba(255,255,255,.04);
  border:1px solid var(--border2);
  border-radius:10px;
  font-family:inherit;font-size:14px;font-weight:600;
  color:var(--fg2);cursor:pointer;
  transition:all .25s;
  display:flex;align-items:center;justify-content:center;gap:8px;
  margin-bottom:10px;
}

.settings-btn:hover{border-color:var(--cyan);color:var(--cyan);background:rgba(0,229,255,.05)}
.settings-btn.danger:hover{border-color:var(--red);color:var(--red);background:rgba(239,68,68,.05)}
.settings-btn svg{width:16px;height:16px}

/* â”€â”€ QR Modal â”€â”€ */
.qr-container {
  text-align:center;padding:8px 0;
}

.qr-url {
  font-size:13px;color:var(--cyan2);
  word-break:break-all;margin-bottom:20px;
}

.qr-box {
  background:white;padding:20px;
  border-radius:16px;display:inline-block;
  box-shadow:0 8px 32px rgba(0,0,0,.4);
}

/* â”€â”€ Toast â”€â”€ */
.toast {
  position:fixed;bottom:28px;
  left:50%;transform:translateX(-50%) translateY(80px);
  background:var(--bg2);color:var(--fg);
  border:1px solid var(--border2);
  border-radius:14px;
  padding:13px 22px;
  box-shadow:0 12px 40px rgba(0,0,0,.5);
  z-index:9999;
  display:flex;align-items:center;gap:10px;
  font-size:14px;font-weight:600;
  transition:all .4s cubic-bezier(.34,1.56,.64,1);
  max-width:90%;white-space:nowrap;
  pointer-events:none;
}

.toast.show{transform:translateX(-50%) translateY(0)}

.toast.success .t-dot{background:var(--emerald)}
.toast.error .t-dot{background:var(--red)}
.toast.info .t-dot{background:var(--cyan)}

.t-dot {
  width:8px;height:8px;border-radius:50%;
  flex-shrink:0;
}

/* â”€â”€ Responsive â”€â”€ */
@media(max-width:900px) {
  .header-inner{padding:0 16px}
  .main{padding:20px 16px 48px}
  .h-search{display:none}
  .hero-banner{padding:28px 24px}
}

@media(max-width:640px) {
  .cards-grid{grid-template-columns:1fr}
  .hero-stats{gap:20px}
  .stats-grid{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>
<body>

<canvas id="bg-canvas"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOGIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="login-page">
  <div class="login-wrap">
    <div class="login-glow"></div>
    <div class="login-card">
      <div class="login-logo">
        <div class="login-logo-icon">âš¡</div>
        <div class="login-logo-text">NEXUS</div>
      </div>
      <p class="login-subtitle">Ù…Ø¯ÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠ â€” Ø§Ø­ÙØ¸ ÙƒÙˆØ±Ø³Ø§ØªÙƒØŒ Ø£Ø¯ÙˆØ§ØªÙƒØŒ<br>IPs ÙˆÙ…ÙˆØ§Ø±Ø¯Ùƒ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯ Ø¢Ù…Ù†</p>
      <div class="setup-badge" id="setup-badge">
        âœ¨ Ø¥Ø¹Ø¯Ø§Ø¯ Ø£ÙˆÙ„ÙŠ â€” Ø£Ù†Ø´Ø¦ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±Ùƒ Ø§Ù„Ø®Ø§ØµØ©
      </div>
      <div id="login-form">
        <label class="field-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <div class="field-wrap">
          <input class="field-input" id="pw-inp" type="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±..." autocomplete="off">
          <span class="field-icon">ğŸ”‘</span>
        </div>
        <div id="confirm-row" style="display:none">
          <label class="field-label">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
          <div class="field-wrap">
            <input class="field-input" id="pw-confirm" type="password" placeholder="Ø£Ø¹Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„..." autocomplete="off">
            <span class="field-icon">ğŸ”’</span>
          </div>
        </div>
        <button class="login-btn" id="login-btn" onclick="doLogin()">
          <span id="login-btn-text">Ø¯Ø®ÙˆÙ„ â†</span>
        </button>
        <div class="attempts-bar" id="attempts-bar"></div>
        <div class="login-error" id="login-error"></div>
        <div class="locked-state" id="locked-state">
          <div class="lock-icon">ğŸ”’</div>
          <h3>Ø§Ù„ÙˆØµÙˆÙ„ Ù…Ù‚ÙÙ„ Ù…Ø¤Ù‚ØªØ§Ù‹</h3>
          <p id="locked-text"></p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• APP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app">
  <header class="app-header">
    <div class="header-inner">
      <div class="h-logo">
        <div class="h-logo-icon">âš¡</div>
        <div class="h-logo-name">NEXUS</div>
      </div>
      <div class="h-search">
        <span class="h-search-ico">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        </span>
        <input type="text" id="search-inp" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø±ÙˆØ§Ø¨Ø·ØŒ IPsØŒ Ø¹Ù†Ø§ÙˆÙŠÙ†ØŒ ÙˆØ³ÙˆÙ…..." oninput="handleSearch()" dir="rtl">
      </div>
      <div class="h-actions">
        <button class="h-btn" onclick="openSettingsModal()" title="Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
        </button>
        <button class="h-btn" onclick="doLogout()" title="Ø®Ø±ÙˆØ¬">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
        </button>
        <button class="h-btn-add" onclick="openAddModal()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·
        </button>
      </div>
    </div>
  </header>

  <main class="main">
    <!-- Hero Banner -->
    <div class="hero-banner">
      <div class="hero-content">
        <h1 class="hero-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="hero-greeting">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! ğŸ‘‹</span></h1>
        <p class="hero-desc">ÙƒÙ„ Ù…ÙˆØ§Ø±Ø¯Ùƒ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯ â€” Ù…Ù†Ø¸Ù…Ø©ØŒ Ù…Ø­Ù…ÙŠØ©ØŒ ÙˆØ³Ù‡Ù„Ø© Ø§Ù„ÙˆØµÙˆÙ„</p>
        <div class="hero-stats">
          <div class="hero-stat">
            <div class="hs-val" id="hs-total">0</div>
            <div class="hs-lbl">Ø±Ø§Ø¨Ø·</div>
          </div>
          <div class="hero-stat-div"></div>
          <div class="hero-stat">
            <div class="hs-val" id="hs-visits">0</div>
            <div class="hs-lbl">Ø²ÙŠØ§Ø±Ø©</div>
          </div>
          <div class="hero-stat-div"></div>
          <div class="hero-stat">
            <div class="hs-val" id="hs-favs">0</div>
            <div class="hs-lbl">Ù…ÙØ¶Ù„Ø©</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats / Filter Cards -->
    <div class="stats-grid" id="stats-grid">
      <div class="stat-card active-filter" onclick="filterCat('all',this)">
        <div class="stat-ico all"><svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg></div>
        <div class="stat-info"><h3 id="sc-all">0</h3><p>Ø§Ù„ÙƒÙ„</p></div>
      </div>
      <div class="stat-card" onclick="filterCat('course',this)">
        <div class="stat-ico course"><svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg></div>
        <div class="stat-info"><h3 id="sc-course">0</h3><p>ÙƒÙˆØ±Ø³Ø§Øª</p></div>
      </div>
      <div class="stat-card" onclick="filterCat('tool',this)">
        <div class="stat-ico tool"><svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg></div>
        <div class="stat-info"><h3 id="sc-tool">0</h3><p>Ø£Ø¯ÙˆØ§Øª</p></div>
      </div>
      <div class="stat-card" onclick="filterCat('article',this)">
        <div class="stat-ico article"><svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg></div>
        <div class="stat-info"><h3 id="sc-article">0</h3><p>Ù…Ù‚Ø§Ù„Ø§Øª</p></div>
      </div>
      <div class="stat-card" onclick="filterCat('important',this)">
        <div class="stat-ico important"><svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></div>
        <div class="stat-info"><h3 id="sc-important">0</h3><p>Ù…Ù‡Ù…Ø©</p></div>
      </div>
      <div class="stat-card" onclick="filterCat('favorite',this)">
        <div class="stat-ico fav"><svg viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg></div>
        <div class="stat-info"><h3 id="sc-fav">0</h3><p>Ø§Ù„Ù…ÙØ¶Ù„Ø©</p></div>
      </div>
      <div class="stat-card" onclick="filterCat('other',this)">
        <div class="stat-ico other"><svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg></div>
        <div class="stat-info"><h3 id="sc-other">0</h3><p>Ø£Ø®Ø±Ù‰</p></div>
      </div>
    </div>

    <!-- Controls Bar -->
    <div class="controls-bar">
      <div class="view-toggle">
        <button class="vt-btn active" id="vt-grid" onclick="setView('grid')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
        </button>
        <button class="vt-btn" id="vt-list" onclick="setView('list')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
        </button>
      </div>
      <select class="sort-select" id="sort-sel" onchange="renderLinks()">
        <option value="newest">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
        <option value="oldest">Ø§Ù„Ø£Ù‚Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹</option>
        <option value="az">Ø£Ø¨Ø¬Ø¯ÙŠ Ø£-ÙŠ</option>
        <option value="visits">Ø§Ù„Ø£ÙƒØ«Ø± Ø²ÙŠØ§Ø±Ø©Ù‹</option>
      </select>
      <div class="results-count" id="results-count"></div>
    </div>

    <!-- Cards Container -->
    <div id="cards-container" class="cards-grid"></div>
  </main>
</div>

<!-- â•â•â•â•â•â• ADD/EDIT MODAL â•â•â•â•â•â• -->
<div class="modal-overlay" id="add-modal">
  <div class="modal">
    <div class="modal-head">
      <h2 id="modal-title">Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯</h2>
      <button class="modal-close" onclick="closeAddModal()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <input type="hidden" id="edit-id">
      <div class="form-group">
        <label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† *</label>
        <input class="form-input" id="f-title" type="text" placeholder="Ù…Ø«Ø§Ù„: ÙƒÙˆØ±Ø³ React.js Ø§Ù„ÙƒØ§Ù…Ù„">
      </div>
      <div class="form-group">
        <label class="form-label">Ø§Ù„Ø±Ø§Ø¨Ø· / IP / Ø§Ù„Ø¹Ù†ÙˆØ§Ù† *</label>
        <input class="form-input" id="f-url" type="text" placeholder="https://example.com Ø£Ùˆ 192.168.1.1:8080">
      </div>
      <div class="form-group">
        <label class="form-label">ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù</label>
        <div class="img-zone" id="img-zone">
          <input type="file" accept="image/*" onchange="handleImg(event)" id="img-file">
          <div class="img-zone-icon">ğŸ–¼ï¸</div>
          <div class="img-zone-text">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø£Ùˆ <span>Ø§Ø³Ø­Ø¨ Ù‡Ù†Ø§</span></div>
          <div style="font-size:11px;color:var(--fg3);margin-top:6px">PNG, JPG, WebP, GIF</div>
        </div>
        <div class="img-preview-wrap" id="img-preview" style="display:none">
          <img id="preview-img" src="" alt="">
          <button class="img-preview-remove" onclick="removeImg()">Ã—</button>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
        <div class="form-group" style="margin-bottom:0">
          <label class="form-label">Ø§Ù„ØªØµÙ†ÙŠÙ *</label>
          <select class="form-select" id="f-cat">
            <option value="course">ğŸ“ ÙƒÙˆØ±Ø³ ØªØ¹Ù„ÙŠÙ…ÙŠ</option>
            <option value="tool">ğŸ”§ Ø£Ø¯Ø§Ø© Ù…Ù‡Ù…Ø©</option>
            <option value="article">ğŸ“„ Ù…Ù‚Ø§Ù„</option>
            <option value="important">â­ Ù…ÙˆÙ‚Ø¹ Ù…Ù‡Ù…</option>
            <option value="other">ğŸ“ Ø£Ø®Ø±Ù‰</option>
          </select>
        </div>
        <div class="form-group" style="margin-bottom:0">
          <label class="form-label">Ø§Ù„ÙˆØ³ÙˆÙ… (ÙØ§ØµÙ„Ø©)</label>
          <input class="form-input" id="f-tags" type="text" placeholder="react, js, design">
        </div>
      </div>
      <div class="form-group" style="margin-top:16px">
        <label class="form-label">ÙˆØµÙ Ù…Ø®ØªØµØ±</label>
        <textarea class="form-textarea" id="f-desc" placeholder="ÙˆØµÙ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø±Ø§Ø¨Ø·..."></textarea>
      </div>
      <div class="form-group">
        <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ©</label>
        <textarea class="form-textarea" id="f-notes" rows="2" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ø§Ù„Ø®Ø§ØµØ© Ù„Ù† ØªÙØ¹Ø±Ø¶..." style="min-height:70px"></textarea>
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn-cancel" onclick="closeAddModal()">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn-save" onclick="saveLink()">
        <span id="save-btn-text">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø·</span>
      </button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â• QR MODAL â•â•â•â•â•â• -->
<div class="modal-overlay" id="qr-modal">
  <div class="modal" style="max-width:380px">
    <div class="modal-head">
      <h2>Ø±Ù…Ø² QR</h2>
      <button class="modal-close" onclick="closeModal('qr-modal')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <div class="qr-container">
        <div class="qr-url" id="qr-url-text"></div>
        <div class="qr-box"><canvas id="qr-canvas"></canvas></div>
        <button class="btn-save" style="margin-top:20px;width:100%" onclick="downloadQR()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ QR</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â• SETTINGS MODAL â•â•â•â•â•â• -->
<div class="modal-overlay" id="settings-modal">
  <div class="modal" style="max-width:500px">
    <div class="modal-head">
      <h2>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <button class="modal-close" onclick="closeModal('settings-modal')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <div class="settings-section">
        <div class="settings-section-title">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
        <button class="settings-btn" onclick="exportData()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ JSON
        </button>
        <label style="cursor:pointer;display:block">
          <input type="file" accept=".json" onchange="importData(event)" style="display:none">
          <div class="settings-btn" style="cursor:pointer;margin:0">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
            Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† JSON
          </div>
        </label>
      </div>
      <div class="settings-section">
        <div class="settings-section-title">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</div>
        <div class="form-group">
          <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
          <input class="form-input" id="set-pw" type="password" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©...">
        </div>
        <div class="form-group">
          <label class="form-label">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
          <input class="form-input" id="set-pw2" type="password" placeholder="Ø£Ø¹Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„...">
        </div>
        <button class="settings-btn" onclick="changePw()">ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
      </div>
      <div class="settings-section">
        <div class="settings-section-title">Ø®Ø·Ø±</div>
        <button class="settings-btn danger" onclick="clearAll()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
          Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast">
  <div class="t-dot"></div>
  <span id="toast-msg"></span>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CANVAS BACKGROUND
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const bgCanvas = document.getElementById('bg-canvas');
const bgCtx = bgCanvas.getContext('2d');
const particles = [];

function resizeBG() {
  bgCanvas.width = window.innerWidth;
  bgCanvas.height = window.innerHeight;
}
resizeBG();
window.addEventListener('resize', resizeBG);

class BgParticle {
  constructor() { this.reset(); }
  reset() {
    this.x = Math.random() * bgCanvas.width;
    this.y = Math.random() * bgCanvas.height;
    this.r = Math.random() * 1.5 + .3;
    this.vx = (Math.random() - .5) * .3;
    this.vy = (Math.random() - .5) * .3;
    this.life = 1;
    this.hue = Math.random() > .5 ? 260 : 190;
  }
  update() {
    this.x += this.vx; this.y += this.vy;
    if (this.x<0||this.x>bgCanvas.width||this.y<0||this.y>bgCanvas.height) this.reset();
  }
  draw() {
    bgCtx.beginPath();
    bgCtx.arc(this.x, this.y, this.r, 0, Math.PI*2);
    bgCtx.fillStyle = `hsla(${this.hue},80%,65%,.6)`;
    bgCtx.fill();
  }
}

for (let i = 0; i < 120; i++) particles.push(new BgParticle());

// Draw connecting lines
function drawConnections() {
  for (let i = 0; i < particles.length; i++) {
    for (let j = i+1; j < particles.length; j++) {
      const dx = particles[i].x - particles[j].x;
      const dy = particles[i].y - particles[j].y;
      const dist = Math.sqrt(dx*dx+dy*dy);
      if (dist < 120) {
        bgCtx.beginPath();
        bgCtx.moveTo(particles[i].x, particles[i].y);
        bgCtx.lineTo(particles[j].x, particles[j].y);
        bgCtx.strokeStyle = `rgba(124,58,237,${(1-dist/120)*.15})`;
        bgCtx.lineWidth = .5;
        bgCtx.stroke();
      }
    }
  }
}

function animateBG() {
  bgCtx.clearRect(0,0,bgCanvas.width,bgCanvas.height);
  particles.forEach(p => { p.update(); p.draw(); });
  drawConnections();
  requestAnimationFrame(animateBG);
}
animateBG();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CARD CANVAS PLACEHOLDERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CAT_COLORS = {
  course:    ['#ec4899','#f43f5e'],
  tool:      ['#00e5ff','#00b4d8'],
  article:   ['#f59e0b','#ef4444'],
  important: ['#10b981','#06b6d4'],
  other:     ['#7c3aed','#a855f7']
};

function drawCardCanvas(canvas, cat) {
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const w = canvas.width = canvas.offsetWidth || 280;
  const h = canvas.height = canvas.offsetHeight || 170;
  const [c1, c2] = CAT_COLORS[cat] || ['#7c3aed','#a855f7'];

  const grad = ctx.createLinearGradient(0,0,w,h);
  grad.addColorStop(0, c1 + '33');
  grad.addColorStop(1, c2 + '22');
  ctx.fillStyle = grad; ctx.fillRect(0,0,w,h);

  // Grid
  ctx.strokeStyle = 'rgba(255,255,255,.04)'; ctx.lineWidth = 1;
  for (let x = 0; x < w; x += 28) {
    ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,h); ctx.stroke();
  }
  for (let y = 0; y < h; y += 28) {
    ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke();
  }

  // Glowing circles
  const rg = ctx.createRadialGradient(w*.3,h*.4,0,w*.3,h*.4,w*.5);
  rg.addColorStop(0, c1 + '55'); rg.addColorStop(1,'transparent');
  ctx.fillStyle = rg; ctx.fillRect(0,0,w,h);

  const rg2 = ctx.createRadialGradient(w*.75,h*.7,0,w*.75,h*.7,w*.4);
  rg2.addColorStop(0, c2 + '44'); rg2.addColorStop(1,'transparent');
  ctx.fillStyle = rg2; ctx.fillRect(0,0,w,h);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// APP STATE & STORAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let links = [];
let currentFilter = 'all';
let currentView = 'grid';
let editId = null;
let coverImg = null;

const LS = {
  get: k => { try { const v = localStorage.getItem(k); return v ? JSON.parse(v) : null; } catch { return null; } },
  set: (k,v) => localStorage.setItem(k, JSON.stringify(v)),
  str: k => localStorage.getItem(k),
  setStr: (k,v) => localStorage.setItem(k,v),
  rm: k => localStorage.removeItem(k)
};

function loadAll() {
  links = LS.get('nx_links') || [];
}

function saveLinks() {
  LS.set('nx_links', links);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initAuth() {
  checkLock();
  const stored = LS.str('nx_pw');
  if (!stored) {
    document.getElementById('setup-badge').style.display = 'flex';
    document.getElementById('confirm-row').style.display = 'block';
    document.getElementById('login-btn-text').textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ â†';
  }
}

function checkLock() {
  const until = LS.str('nx_lock');
  if (!until) return;
  const lockDate = new Date(until);
  if (new Date() < lockDate) {
    showLocked(lockDate);
  } else {
    LS.rm('nx_lock');
    LS.setStr('nx_attempts','0');
  }
}

function showLocked(lockDate) {
  document.getElementById('login-form').style.display = 'none';
  const days = Math.ceil((lockDate - new Date()) / 86400000);
  document.getElementById('locked-text').textContent = `Ø³ÙŠÙØ±ÙØ¹ Ø§Ù„Ù‚ÙÙ„ Ø¨Ø¹Ø¯ ${days} ÙŠÙˆÙ…`;
  document.getElementById('locked-state').style.display = 'block';
}

function doLogin() {
  const pw = document.getElementById('pw-inp').value.trim();
  const stored = LS.str('nx_pw');
  const errEl = document.getElementById('login-error');
  const attEl = document.getElementById('attempts-bar');
  errEl.style.display = 'none';

  if (!pw) { showErr(errEl, 'âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±'); return; }

  if (!stored) {
    const conf = document.getElementById('pw-confirm').value.trim();
    if (pw.length < 4) { showErr(errEl,'âš ï¸ 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„'); return; }
    if (pw !== conf) { showErr(errEl,'âš ï¸ ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†'); return; }
    LS.setStr('nx_pw', btoa(unescape(encodeURIComponent(pw))));
    enterApp();
  } else {
    let decoded;
    try { decoded = decodeURIComponent(escape(atob(stored))); } catch { decoded = atob(stored); }
    if (pw === decoded) {
      LS.setStr('nx_attempts','0');
      enterApp();
    } else {
      const att = parseInt(LS.str('nx_attempts') || '0') + 1;
      LS.setStr('nx_attempts', att.toString());
      if (att >= 8) {
        const lock = new Date(); lock.setMonth(lock.getMonth()+1);
        LS.setStr('nx_lock', lock.toISOString());
        showLocked(lock);
      } else {
        attEl.style.display = 'block';
        attEl.textContent = `âš ï¸ Ø¨Ø§Ù‚ÙŠ ${8-att} Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù‚ÙÙ„ Ù„Ø´Ù‡Ø± ÙƒØ§Ù…Ù„`;
        showErr(errEl,'âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
      }
    }
  }
}

function showErr(el, msg) { el.textContent = msg; el.style.display = 'block'; }

function enterApp() {
  document.getElementById('login-page').style.display = 'none';
  document.getElementById('app').style.display = 'block';
  renderLinks();
}

function doLogout() {
  document.getElementById('app').style.display = 'none';
  document.getElementById('login-page').style.display = 'flex';
  document.getElementById('pw-inp').value = '';
  document.getElementById('login-error').style.display = 'none';
  document.getElementById('attempts-bar').style.display = 'none';
}

document.addEventListener('keydown', e => {
  if (e.key === 'Enter' && document.getElementById('login-page').style.display !== 'none') doLogin();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getDisplayLinks() {
  const q = document.getElementById('search-inp')?.value.toLowerCase().trim();
  let list = [...links];

  if (currentFilter === 'favorite') list = list.filter(l => l.fav);
  else if (currentFilter !== 'all') list = list.filter(l => l.cat === currentFilter);

  if (q) list = list.filter(l =>
    l.title.toLowerCase().includes(q) ||
    l.url.toLowerCase().includes(q) ||
    (l.desc||'').toLowerCase().includes(q) ||
    (l.tags||[]).some(t => t.toLowerCase().includes(q))
  );

  const sort = document.getElementById('sort-sel')?.value || 'newest';
  if (sort === 'newest') list.sort((a,b) => b.ts - a.ts);
  else if (sort === 'oldest') list.sort((a,b) => a.ts - b.ts);
  else if (sort === 'az') list.sort((a,b) => a.title.localeCompare(b.title, 'ar'));
  else if (sort === 'visits') list.sort((a,b) => (b.visits||0) - (a.visits||0));

  return list;
}

function updateStats() {
  document.getElementById('hs-total').textContent = links.length;
  document.getElementById('hs-visits').textContent = links.reduce((s,l)=>s+(l.visits||0),0);
  document.getElementById('hs-favs').textContent = links.filter(l=>l.fav).length;
  document.getElementById('sc-all').textContent = links.length;
  document.getElementById('sc-course').textContent = links.filter(l=>l.cat==='course').length;
  document.getElementById('sc-tool').textContent = links.filter(l=>l.cat==='tool').length;
  document.getElementById('sc-article').textContent = links.filter(l=>l.cat==='article').length;
  document.getElementById('sc-important').textContent = links.filter(l=>l.cat==='important').length;
  document.getElementById('sc-fav').textContent = links.filter(l=>l.fav).length;
  document.getElementById('sc-other').textContent = links.filter(l=>l.cat==='other').length;
}

const CAT_NAMES = {course:'ÙƒÙˆØ±Ø³ ØªØ¹Ù„ÙŠÙ…ÙŠ',tool:'Ø£Ø¯Ø§Ø© Ù…Ù‡Ù…Ø©',article:'Ù…Ù‚Ø§Ù„',important:'Ù…ÙˆÙ‚Ø¹ Ù…Ù‡Ù…',other:'Ø£Ø®Ø±Ù‰'};
const CAT_EMOJI = {course:'ğŸ“',tool:'ğŸ”§',article:'ğŸ“„',important:'â­',other:'ğŸ“'};

function renderLinks() {
  updateStats();
  const list = getDisplayLinks();
  const container = document.getElementById('cards-container');
  container.className = currentView === 'list' ? 'cards-list' : 'cards-grid';

  document.getElementById('results-count').innerHTML = list.length
    ? `Ø¹Ø±Ø¶ <span>${list.length}</span> Ù…Ù† ${links.length}`
    : '';

  if (!list.length) {
    container.innerHTML = `
    <div class="empty-state">
      <div class="empty-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"/><polyline points="13 2 13 9 20 9"/></svg>
      </div>
      <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ù‡Ù†Ø§</h3>
      <p>${links.length ? 'Ø¬Ø±Ù‘Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„ØªØµÙÙŠØ© Ø£Ùˆ Ø§Ù„Ø¨Ø­Ø«' : 'Ø£Ø¶Ù Ø£ÙˆÙ„ Ø±Ø§Ø¨Ø· Ù„Ùƒ Ø§Ù„Ø¢Ù†!'}</p>
      <button class="h-btn-add" onclick="openAddModal()" style="margin:0 auto">+ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·</button>
    </div>`;
    return;
  }

  const listMode = currentView === 'list' ? 'list-mode' : '';

  container.innerHTML = list.map((l, i) => `
  <div class="link-card ${l.cat} ${listMode}" style="animation-delay:${i*.04}s" id="card-${l.id}">
    <div class="card-img">
      ${l.image
        ? `<img src="${l.image}" alt="${l.title}">`
        : `<div class="card-img-ph"><canvas id="ph-${l.id}" style="position:absolute;inset:0;width:100%;height:100%"></canvas><span class="ph-icon">${CAT_EMOJI[l.cat]||'ğŸ”—'}</span></div>`
      }
      <div class="card-img-overlay"></div>
      <div class="card-actions-float">
        <button class="ca-btn ${l.fav?'fav-on':''}" onclick="toggleFav('${l.id}',event)" title="${l.fav?'Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©':'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©'}">
          <svg viewBox="0 0 24 24" fill="${l.fav?'currentColor':'none'}" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
        </button>
        <button class="ca-btn" onclick="openEditModal('${l.id}',event)" title="ØªØ¹Ø¯ÙŠÙ„">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
        </button>
        <button class="ca-btn" onclick="openQR('${l.url}',event)" title="QR Code">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="3" height="3"/><rect x="19" y="14" width="2" height="2"/><rect x="14" y="19" width="2" height="2"/><rect x="18" y="18" width="3" height="3"/></svg>
        </button>
        <button class="ca-btn del-btn" onclick="deleteLink('${l.id}',event)" title="Ø­Ø°Ù">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg>
        </button>
      </div>
      <span class="card-cat-badge ${l.cat}">${CAT_NAMES[l.cat]||l.cat}</span>
    </div>
    <div class="card-body">
      <div class="card-title">${l.title}</div>
      <div class="card-url" onclick="copyUrl('${l.url}',event)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
        ${l.url.length > 45 ? l.url.slice(0,45)+'â€¦' : l.url}
      </div>
      ${l.desc ? `<div class="card-desc">${l.desc}</div>` : ''}
      ${l.tags?.length ? `<div class="card-tags">${l.tags.slice(0,4).map(t=>`<span class="card-tag">#${t}</span>`).join('')}</div>` : ''}
      <div class="card-footer">
        <div class="card-meta">
          <span class="card-meta-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
            ${l.visits||0}
          </span>
          <span class="card-meta-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
            ${fmtDate(l.ts)}
          </span>
        </div>
        <button class="card-visit-btn" onclick="visitLink('${l.id}','${l.url}',event)">
          Ø²ÙŠØ§Ø±Ø©
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
        </button>
      </div>
    </div>
  </div>`).join('');

  // Draw placeholders after DOM update
  requestAnimationFrame(() => {
    list.forEach(l => {
      if (!l.image) {
        const c = document.getElementById('ph-'+l.id);
        if (c) drawCardCanvas(c, l.cat);
      }
    });
  });
}

function fmtDate(ts) {
  return new Date(ts).toLocaleDateString('ar-SA', {year:'numeric',month:'short',day:'numeric'});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FILTER & SORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function filterCat(cat, el) {
  currentFilter = cat;
  document.querySelectorAll('.stat-card').forEach(c => c.classList.remove('active-filter'));
  if (el) el.classList.add('active-filter');
  renderLinks();
}

function handleSearch() { renderLinks(); }

function setView(v) {
  currentView = v;
  document.getElementById('vt-grid').classList.toggle('active', v==='grid');
  document.getElementById('vt-list').classList.toggle('active', v==='list');
  renderLinks();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CRUD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function visitLink(id, url, e) {
  if (e) e.stopPropagation();
  const l = links.find(x=>x.id===id);
  if (l) { l.visits=(l.visits||0)+1; l.lastVisit=Date.now(); saveLinks(); updateStats(); }
  window.open(url,'_blank');
}

function toggleFav(id, e) {
  if (e) e.stopPropagation();
  const l = links.find(x=>x.id===id);
  if (l) {
    l.fav = !l.fav;
    saveLinks(); renderLinks();
    showToast(l.fav?'â¤ï¸ Ø£ÙØ¶ÙŠÙ Ù„Ù„Ù…ÙØ¶Ù„Ø©':'ğŸ’” Ø£ÙØ²ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©', 'info');
  }
}

function copyUrl(url, e) {
  if (e) e.stopPropagation();
  navigator.clipboard.writeText(url).then(() => showToast('ğŸ“‹ ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·', 'success'));
}

function deleteLink(id, e) {
  if (e) e.stopPropagation();
  if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ')) return;
  links = links.filter(l=>l.id!==id);
  saveLinks(); renderLinks();
  showToast('ğŸ—‘ï¸ ØªÙ… Ø§Ù„Ø­Ø°Ù', 'error');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADD / EDIT MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openAddModal() {
  editId = null; coverImg = null;
  document.getElementById('modal-title').textContent = 'âœ¨ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯';
  document.getElementById('save-btn-text').textContent = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø·';
  ['f-title','f-url','f-tags','f-desc','f-notes'].forEach(id => document.getElementById(id).value='');
  document.getElementById('f-cat').value = 'course';
  document.getElementById('img-preview').style.display='none';
  document.getElementById('img-zone').style.display='block';
  document.getElementById('add-modal').style.display='flex';
}

function openEditModal(id, e) {
  if (e) e.stopPropagation();
  const l = links.find(x=>x.id===id);
  if (!l) return;
  editId = id; coverImg = l.image||null;
  document.getElementById('modal-title').textContent = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·';
  document.getElementById('save-btn-text').textContent = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
  document.getElementById('f-title').value = l.title;
  document.getElementById('f-url').value = l.url;
  document.getElementById('f-cat').value = l.cat;
  document.getElementById('f-tags').value = (l.tags||[]).join(', ');
  document.getElementById('f-desc').value = l.desc||'';
  document.getElementById('f-notes').value = l.notes||'';
  if (l.image) {
    document.getElementById('preview-img').src = l.image;
    document.getElementById('img-preview').style.display='block';
    document.getElementById('img-zone').style.display='none';
  } else {
    document.getElementById('img-preview').style.display='none';
    document.getElementById('img-zone').style.display='block';
  }
  document.getElementById('add-modal').style.display='flex';
}

function closeAddModal() {
  document.getElementById('add-modal').style.display='none';
  editId = null; coverImg = null;
}

function handleImg(e) {
  const file = e.target.files[0]; if (!file) return;
  const r = new FileReader();
  r.onload = ev => {
    coverImg = ev.target.result;
    document.getElementById('preview-img').src = coverImg;
    document.getElementById('img-preview').style.display='block';
    document.getElementById('img-zone').style.display='none';
  };
  r.readAsDataURL(file);
}

function removeImg() {
  coverImg = null;
  document.getElementById('img-preview').style.display='none';
  document.getElementById('img-zone').style.display='block';
  document.getElementById('img-file').value='';
}

function saveLink() {
  const title = document.getElementById('f-title').value.trim();
  const url = document.getElementById('f-url').value.trim();
  if (!title || !url) { showToast('âš ï¸ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø±Ø§Ø¨Ø· Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'error'); return; }
  const rawTags = document.getElementById('f-tags').value.trim();
  const tags = rawTags ? rawTags.split(',').map(t=>t.trim()).filter(Boolean) : [];

  if (editId) {
    const idx = links.findIndex(l=>l.id===editId);
    if (idx>-1) {
      links[idx] = { ...links[idx], title, url,
        cat: document.getElementById('f-cat').value,
        tags, desc: document.getElementById('f-desc').value.trim(),
        notes: document.getElementById('f-notes').value.trim(),
        image: coverImg !== null ? coverImg : links[idx].image,
        updated: Date.now()
      };
    }
    showToast('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¨Ø·', 'success');
  } else {
    links.unshift({
      id: Date.now().toString(36) + Math.random().toString(36).slice(2,5),
      title, url,
      cat: document.getElementById('f-cat').value,
      tags, desc: document.getElementById('f-desc').value.trim(),
      notes: document.getElementById('f-notes').value.trim(),
      image: coverImg, fav:false, visits:0, ts:Date.now()
    });
    showToast('ğŸš€ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø·', 'success');
  }
  saveLinks(); renderLinks(); closeAddModal();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QR CODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openQR(url, e) {
  if (e) e.stopPropagation();
  document.getElementById('qr-url-text').textContent = url;
  document.getElementById('qr-modal').style.display='flex';
  genQR(url);
}

function genQR(text) {
  const canvas = document.getElementById('qr-canvas');
  const ctx = canvas.getContext('2d');
  const size = 180; canvas.width=size; canvas.height=size;
  ctx.fillStyle='#fff'; ctx.fillRect(0,0,size,size);
  ctx.fillStyle='#000';
  const cell = size/25;
  for (let i=0;i<25;i++) for (let j=0;j<25;j++) {
    if (Math.random()>.5 || (i<7&&j<7) || (i<7&&j>17) || (i>17&&j<7))
      ctx.fillRect(i*cell,j*cell,cell,cell);
  }
  [0, 18*cell].forEach(x => [0, (x?0:18*cell)].forEach(y => {
    ctx.fillStyle='#000'; ctx.fillRect(x||0,x===0&&y===18*cell?18*cell:y===0?0:y,7*cell,7*cell);
    ctx.fillStyle='#fff'; ctx.fillRect((x||0)+cell,(x===0&&y===18*cell?18*cell:y===0?0:y)+cell,5*cell,5*cell);
    ctx.fillStyle='#000'; ctx.fillRect((x||0)+2*cell,(x===0&&y===18*cell?18*cell:y===0?0:y)+2*cell,3*cell,3*cell);
  }));
  const [c1,c2] = CAT_COLORS['other'];
  const grd = ctx.createLinearGradient(8*cell,8*cell,17*cell,17*cell);
  grd.addColorStop(0,c1); grd.addColorStop(1,c2);
  ctx.fillStyle=grd; ctx.fillRect(8*cell,8*cell,9*cell,9*cell);
}

function downloadQR() {
  const a=document.createElement('a'); a.download='qr.png';
  a.href=document.getElementById('qr-canvas').toDataURL(); a.click();
  showToast('â¬‡ï¸ ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„','success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openSettingsModal() {
  document.getElementById('settings-modal').style.display='flex';
}

function changePw() {
  const p = document.getElementById('set-pw').value;
  const p2 = document.getElementById('set-pw2').value;
  if (p.length < 4) { showToast('âš ï¸ 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„','error'); return; }
  if (p !== p2) { showToast('âš ï¸ ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªÙŠÙ†','error'); return; }
  LS.setStr('nx_pw', btoa(unescape(encodeURIComponent(p))));
  document.getElementById('set-pw').value='';
  document.getElementById('set-pw2').value='';
  showToast('ğŸ”‘ ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±','success');
}

function exportData() {
  const blob = new Blob([JSON.stringify({links,exported:new Date().toISOString(),v:'4.0'},null,2)],{type:'application/json'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `nexus-backup-${Date.now()}.json`;
  a.click(); URL.revokeObjectURL(a.href);
  showToast('ğŸ“¦ ØªÙ… Ø§Ù„ØªØµØ¯ÙŠØ±','success');
}

function importData(e) {
  const file = e.target.files[0]; if (!file) return;
  const r = new FileReader();
  r.onload = ev => {
    try {
      const data = JSON.parse(ev.target.result);
      if (data.links) {
        if (confirm(`Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${data.links.length} Ø±Ø§Ø¨Ø·ØŸ\nOK = Ø¯Ù…Ø¬ | Cancel = Ø§Ø³ØªØ¨Ø¯Ø§Ù„`)) {
          const ids = new Set(links.map(l=>l.id));
          links = [...links, ...data.links.filter(l=>!ids.has(l.id))];
        } else { links = data.links; }
        saveLinks(); renderLinks();
        showToast(`âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${data.links.length} Ø±Ø§Ø¨Ø·`,'success');
      }
    } catch { showToast('âŒ Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­','error'); }
  };
  r.readAsText(file);
}

function clearAll() {
  if (!confirm('Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹!')) return;
  if (!confirm('Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡. Ù…ØªØ£ÙƒØ¯ØŸ')) return;
  links = []; saveLinks(); renderLinks();
  showToast('ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª','error');
}

function closeModal(id) {
  document.getElementById(id).style.display='none';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let toastTimer;
function showToast(msg, type='info') {
  const t = document.getElementById('toast');
  document.getElementById('toast-msg').textContent = msg;
  t.className = `toast ${type} show`;
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOOT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', () => {
  loadAll();
  initAuth();

  // Greeting
  const hr = new Date().getHours();
  const g = hr < 12 ? 'ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ± â˜€ï¸' : hr < 18 ? 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ù†ÙˆØ± ğŸŒ¤ï¸' : 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ± ğŸŒ™';
  const heroEl = document.getElementById('hero-greeting');
  if (heroEl) heroEl.textContent = g;

  // Close modal on overlay click
  document.querySelectorAll('.modal-overlay').forEach(o => {
    o.addEventListener('click', e => {
      if (e.target === o) o.style.display='none';
    });
  });
});
</script>
</body>
</html>
